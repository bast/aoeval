include_directories(${PROJECT_SOURCE_DIR}/src)
include_directories(${PROJECT_SOURCE_DIR}/api)
include_directories(${PROJECT_BINARY_DIR}/include)

set(_generated_files ${PROJECT_BINARY_DIR}/generated/ao_dispatch.cpp)

foreach(_suffix block explicit)
    foreach(_level RANGE 0 ${MAX_GEO_DIFF_ORDER})
        set(_generated_files ${_generated_files} ${PROJECT_BINARY_DIR}/generated/autogenerated_${_level}_${_suffix}.cpp)
    endforeach()
endforeach()

set_source_files_properties(${_generated_files} PROPERTIES GENERATED TRUE)

add_library(
    balboa
    SHARED
    Main.cpp
    Main.h
    ao_vector.cpp
    ao_vector.h
    ${_generated_files}
    )

add_dependencies(balboa generate)

install(TARGETS balboa LIBRARY DESTINATION lib)
install(FILES ${PROJECT_BINARY_DIR}/include/balboa.h DESTINATION include)
install(FILES ${PROJECT_BINARY_DIR}/include/balboa_export.h DESTINATION include)
